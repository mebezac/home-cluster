controllers:
  changedetection:
    annotations:
      reloader.stakater.com/auto: "true"
    containers:
      app:
        image:
          repository: ghcr.io/dgtlmoon/changedetection.io
          tag: 0.52.7
        env:
          TZ: ${TIMEZONE}
          PORT: &port 5000
          USE_X_SETTINGS: 1
          PLAYWRIGHT_DRIVER_URL: ws://localhost:3000/?stealth=1&--disable-web-security=true&--user-data-dir=~/browserless-cache-123
      browser:
        image:
          repository: browserless/chrome
          tag: latest
          pullPolicy: IfNotPresent
        env:
          SCREEN_WIDTH: "1920"
          SCREEN_HEIGHT: "1024"
          SCREEN_DEPTH: "16"
          ENABLE_DEBUGGER: "false"
          PREBOOT_CHROME: "true"
          CONNECTION_TIMEOUT: "300000"
          MAX_CONCURRENT_SESSIONS: "10"
          CHROME_REFRESH_TIME: "600000"
          DEFAULT_BLOCK_ADS: "true"
          DEFAULT_STEALTH: "true"
service:
  app:
    controller: changedetection
    ports:
      http:
        port: *port
ingress:
  app:
    enabled: true
    className: internal
    hosts:
      - host: changedetection.laboratory.casa
        paths:
          - path: /
            service:
              identifier: app
              port: http
persistence:
  config:
    type: persistentVolumeClaim
    existingClaim: "${VOLSYNC_CLAIM}"
    globalMounts:
      - path: /datastore
