controllers:
  changedetection:
    annotations:
      reloader.stakater.com/auto: "true"
    containers:
      app:
        image:
          repository: ghcr.io/dgtlmoon/changedetection.io
          tag: 0.54.1@sha256:bda857dd1c0680eb2665366ef8fe7472593c5add6558c25825a28e241888c6ea
        env:
          TZ: America/New_York
          PORT: &port 5000
          USE_X_SETTINGS: 1
          PLAYWRIGHT_DRIVER_URL: ws://localhost:3000/?stealth=1&--disable-web-security=true&--user-data-dir=~/browserless-cache-123
      browser:
        image:
          repository: ghcr.io/browserless/chrome
          tag: v2.41.0@sha256:30aab4a8421294f2868025fba07ff7df5c5645433a83fbb863c7b03d904337ac
          pullPolicy: IfNotPresent
        env:
          SCREEN_WIDTH: "1920"
          SCREEN_HEIGHT: "1024"
          SCREEN_DEPTH: "16"
          ENABLE_DEBUGGER: "false"
          PREBOOT_CHROME: "true"
          CONNECTION_TIMEOUT: "300000"
          MAX_CONCURRENT_SESSIONS: "10"
          CHROME_REFRESH_TIME: "600000"
          DEFAULT_BLOCK_ADS: "true"
          DEFAULT_STEALTH: "true"
service:
  app:
    controller: changedetection
    ports:
      http:
        port: *port
ingress:
  app:
    enabled: true
    className: internal
    hosts:
      - host: changedetection.laboratory.casa
        paths:
          - path: /
            service:
              identifier: app
              port: http
persistence:
  config:
    type: persistentVolumeClaim
    storageClass: longhorn
    accessMode: ReadWriteOnce
    size: 512Mi
    globalMounts:
      - path: /datastore
