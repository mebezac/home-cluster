---
defaultPodOptions:
  priorityClassName: system-node-critical
configMaps:
  config:
    data:
      config.yaml: |-
        devices:
          - name: tun
            groups:
              - count: 1000
                paths:
                  - path: /dev/net/tun
controllers:
  generic-device-plugin:
    type: daemonset
    strategy: RollingUpdate
    containers:
      app:
        image:
          repository: ghcr.io/squat/generic-device-plugin
          tag: latest@sha256:359bcdd5c7b45a815a50e2f69c5942d85de6db03ff4a3923462af06161bead08
        args:
          - --log-level=info
          - --config=/config/config.yaml
        resources:
          requests:
            cpu: 10m
          limits:
            memory: 64Mi
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          capabilities:
            drop:
              - ALL
persistence:
  config:
    type: configMap
    identifier: config
    globalMounts:
      - path: /config/config.yaml
        subPath: config.yaml
        readOnly: true
  dev:
    type: hostPath
    hostPath: /dev
    globalMounts:
      - readOnly: true
  sys:
    type: hostPath
    hostPath: /sys
    globalMounts:
      - readOnly: true
  var-lib-kubelet-device-plugins:
    type: hostPath
    hostPath: /var/lib/kubelet/device-plugins
